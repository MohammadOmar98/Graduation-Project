!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports,require("@angular/core"),require("@angular/router"),require("rxjs"),require("rxjs/operators"),require("@angular/common")):"function"==typeof define&&define.amd?define("xng-breadcrumb",["exports","@angular/core","@angular/router","rxjs","rxjs/operators","@angular/common"],r):r((e="undefined"!=typeof globalThis?globalThis:e||self)["xng-breadcrumb"]={},e.ng.core,e.ng.router,e.rxjs,e.rxjs.operators,e.ng.common)}(this,(function(e,r,t,n,a,i){"use strict";var s=function(){};s.decorators=[{type:r.Directive,args:[{selector:"[xngBreadcrumbItem]"}]}];Object.create;function o(e,r){var t="function"==typeof Symbol&&e[Symbol.iterator];if(!t)return e;var n,a,i=t.call(e),s=[];try{for(;(void 0===r||r-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(e){a={error:e}}finally{try{n&&!n.done&&(t=i.return)&&t.call(i)}finally{if(a)throw a.error}}return s}function u(){for(var e=[],r=0;r<arguments.length;r++)e=e.concat(o(arguments[r]));return e}Object.create;var c=":",b="/:[^/]+",d="/[^/]+",l=function(e){return e&&Object.keys(e).length>0},p=l,m=function(){function e(e,r){this.activatedRoute=e,this.router=r,this.baseHref="/",this.dynamicBreadcrumbStore=[],this.currentBreadcrumbs=[],this.previousBreadcrumbs=[],this.breadcrumbs=new n.BehaviorSubject([]),this.breadcrumbs$=this.breadcrumbs.asObservable(),this.detectRouteChanges()}return e.prototype.detectRouteChanges=function(){var e=this;this.router.events.pipe(a.filter((function(e){return e instanceof t.NavigationEnd}))).subscribe((function(){e.previousBreadcrumbs=e.currentBreadcrumbs;var r=e.getRootBreadcrumb();e.currentBreadcrumbs=r?[r]:[],e.prepareBreadcrumbList(e.activatedRoute.root,e.baseHref)}))},e.prototype.getRootBreadcrumb=function(){var e,r=this.router.config.find((function(e){return""===e.path})),t=this.extractObject(null===(e=null==r?void 0:r.data)||void 0===e?void 0:e.breadcrumb),n=this.getFromStore(t.alias,"/");if(l(t)||l(n))return Object.assign(Object.assign(Object.assign(Object.assign({},n),t),{routeLink:this.baseHref}),this.getQueryParamsFromPreviousList("/"))},e.prototype.prepareBreadcrumbItem=function(e,r){var t=this.parseRouteData(e.routeConfig),n=t.path,a=t.breadcrumb,i=this.resolvePathSegment(n,e),s=""+r+i,o=this.getFromStore(a.alias,s),u=this.extractLabel((null==o?void 0:o.label)||(null==a?void 0:a.label),i),c=!1,b="";return u||(c=!0,b=i),Object.assign(Object.assign(Object.assign(Object.assign({},o),a),{label:c?b:u,routeLink:s,isAutoGeneratedLabel:c}),this.getQueryParamsFromPreviousList(s))},e.prototype.prepareBreadcrumbList=function(e,r){if(e.routeConfig&&e.routeConfig.path){var t=this.prepareBreadcrumbItem(e,r);if(this.currentBreadcrumbs.push(t),e.firstChild)return this.prepareBreadcrumbList(e.firstChild,t.routeLink+"/")}else if(e.firstChild)return this.prepareBreadcrumbList(e.firstChild,r);var n=this.currentBreadcrumbs[this.currentBreadcrumbs.length-1];this.setQueryParamsForActiveBreadcrumb(n,e);var a=this.currentBreadcrumbs.filter((function(e){return!e.skip}));this.breadcrumbs.next(a)},e.prototype.getFromStore=function(e,r){var t=this;return this.dynamicBreadcrumbStore.find((function(n){return e&&e===n.alias||r&&r===n.routeLink||t.matchRegex(r,n.routeRegex)}))},e.prototype.matchRegex=function(e,r){var t=e.match(new RegExp(r));return t&&t[0]===e},e.prototype.resolvePathSegment=function(e,r){return e.includes(c)&&Object.entries(r.snapshot.params).forEach((function(r){var t=o(r,2),n=t[0],a=t[1];e=e.replace(":"+n,""+a)})),e},e.prototype.getQueryParamsFromPreviousList=function(e){var r=this.previousBreadcrumbs.find((function(r){return r.routeLink===e}))||{};return{queryParams:r.queryParams,fragment:r.fragment}},e.prototype.setQueryParamsForActiveBreadcrumb=function(e,r){if(e){var t=r.snapshot,n=t.queryParams,a=t.fragment;e.queryParams=n?Object.assign({},n):void 0,e.fragment=a}},e.prototype.parseRouteData=function(e){var r=e.path,t=e.data;return{path:r,breadcrumb:this.mergeWithBaseChildData(e,null==t?void 0:t.breadcrumb)}},e.prototype.mergeWithBaseChildData=function(e,r){var t,n;if(!e)return this.extractObject(r);e.loadChildren?n=e._loadedConfig.routes.find((function(e){return""===e.path})):e.children&&(n=e.children.find((function(e){return""===e.path})));var a=null===(t=null==n?void 0:n.data)||void 0===t?void 0:t.breadcrumb;return a?this.mergeWithBaseChildData(n,Object.assign(Object.assign({},this.extractObject(r)),this.extractObject(a))):this.extractObject(r)},e.prototype.set=function(e,r){var t,n=this.extractObject(r);t=e.startsWith("@")?["alias",Object.assign(Object.assign({},n),{alias:e.slice(1)})]:e.includes(c)?["routeRegex",Object.assign(Object.assign({},n),{routeRegex:this.buildRegex(e)})]:["routeLink",Object.assign(Object.assign({},n),{routeLink:this.ensureLeadingSlash(e)})],this.updateStore.apply(this,u(t)),this.updateCurrentBreadcrumbs.apply(this,u(t))},e.prototype.updateStore=function(e,r){var t=this.dynamicBreadcrumbStore.findIndex((function(t){return r[e]===t[e]}));t>-1?this.dynamicBreadcrumbStore[t]=Object.assign(Object.assign({},this.dynamicBreadcrumbStore[t]),r):this.dynamicBreadcrumbStore.push(Object.assign({},r))},e.prototype.updateCurrentBreadcrumbs=function(e,r){var t=this,n=this.currentBreadcrumbs.findIndex((function(n){return"routeRegex"===e?t.matchRegex(n.routeLink,r[e]):r[e]===n[e]}));if(n>-1){this.currentBreadcrumbs[n]=Object.assign(Object.assign({},this.currentBreadcrumbs[n]),r);var a=this.currentBreadcrumbs.filter((function(e){return!e.skip}));this.breadcrumbs.next(u(a))}},e.prototype.buildRegex=function(e){return this.ensureLeadingSlash(e).replace(new RegExp(b,"g"),d)},e.prototype.ensureLeadingSlash=function(e){return e.startsWith("/")?e:"/"+e},e.prototype.extractLabel=function(e,r){var t="object"==typeof e?e.label:e;return"function"==typeof t?t(r):t},e.prototype.extractObject=function(e){return!e||"string"!=typeof e&&"function"!=typeof e?e||{}:{label:e}},e}();m.ɵprov=r.ɵɵdefineInjectable({factory:function(){return new m(r.ɵɵinject(t.ActivatedRoute),r.ɵɵinject(t.Router))},token:m,providedIn:"root"}),m.decorators=[{type:r.Injectable,args:[{providedIn:"root"}]}],m.ctorParameters=function(){return[{type:t.ActivatedRoute},{type:t.Router}]};var g=function(){function e(e,r){this.breadcrumbService=e,this.router=r,this._separator="/",this.autoGenerate=!0,this.preserveQueryParams=!0,this.preserveFragment=!0,this.class=""}return Object.defineProperty(e.prototype,"separator",{get:function(){return this._separator},set:function(e){e instanceof r.TemplateRef?(this.separatorTemplate=e,this._separator=void 0):(this.separatorTemplate=void 0,this._separator=e||"/")},enumerable:!1,configurable:!0}),e.prototype.ngOnInit=function(){var e=this;this.subscription=this.breadcrumbService.breadcrumbs$.subscribe((function(r){e.breadcrumbs=r.map((function(r){return Object.assign(Object.assign({},r),{queryParams:e.preserveQueryParams?r.queryParams:void 0,fragment:e.preserveFragment?r.fragment:void 0})})).filter((function(r){return!!e.autoGenerate||!r.isAutoGeneratedLabel}))}))},e.prototype.ngOnDestroy=function(){this.subscription.unsubscribe()},e.prototype.handleRoute=function(e){var r=e.routeInterceptor?e.routeInterceptor(e.routeLink,e):e.routeLink,t=e.queryParams,n=e.fragment;this.router.navigate([r],{queryParams:t,fragment:n})},e}();g.decorators=[{type:r.Component,args:[{selector:"xng-breadcrumb",template:'<nav aria-label="breadcrumb" class="xng-breadcrumb-root" [ngClass]="class">\n  <ol class="xng-breadcrumb-list">\n    <ng-container\n      *ngFor="\n        let breadcrumb of breadcrumbs; \n        last as isLast; \n        first as isFirst; \n        index as index; \n        count as count;">\n      <li class="xng-breadcrumb-item">\n        <a\n          *ngIf="!isLast"\n          (click)="handleRoute(breadcrumb)"\n          class="xng-breadcrumb-link"\n          [ngClass]="{ \'xng-breadcrumb-link-disabled\': breadcrumb.disable }"\n          [attr.aria-disabled]="breadcrumb.disable"\n        >\n          <ng-container\n            *ngTemplateOutlet="\n              itemTemplate;\n              context: {\n                $implicit: breadcrumb.label,\n                info: breadcrumb.info,\n                last: isLast,\n                first: isFirst,\n                index: index,\n                count: count\n              }\n            "\n          ></ng-container>\n          <ng-container *ngIf="!itemTemplate">{{\n            breadcrumb.label\n          }}</ng-container>\n        </a>\n\n        <label *ngIf="isLast" class="xng-breadcrumb-trail">\n          <ng-container\n            *ngTemplateOutlet="\n              itemTemplate;\n              context: {\n                $implicit: breadcrumb.label,\n                info: breadcrumb.info,\n                last: isLast,\n                first: isFirst,\n                index: index,\n                count: count\n              }\n            "\n          ></ng-container>\n          <ng-container *ngIf="!itemTemplate">{{\n            breadcrumb.label\n          }}</ng-container>\n        </label>\n      </li>\n\n      <li\n        *ngIf="!isLast"\n        class="xng-breadcrumb-separator"\n        aria-hidden="true"\n        role="separator"\n      >\n        <ng-container *ngTemplateOutlet="separatorTemplate"></ng-container>\n        <ng-container *ngIf="!separatorTemplate">{{ separator }}</ng-container>\n      </li>\n    </ng-container>\n  </ol>\n</nav>\n',encapsulation:r.ViewEncapsulation.None,styles:[".xng-breadcrumb-root{color:rgba(0,0,0,.6);margin:0}.xng-breadcrumb-list{align-items:center;display:flex;flex-wrap:wrap;margin:0;padding:0}.xng-breadcrumb-item{list-style:none}.xng-breadcrumb-trail{align-items:center;color:rgba(0,0,0,.9);display:flex}.xng-breadcrumb-link{align-items:center;color:inherit;display:flex;text-decoration:none;transition:-webkit-text-decoration .3s;transition:text-decoration .3s;transition:text-decoration .3s,-webkit-text-decoration .3s;white-space:nowrap}.xng-breadcrumb-link:hover{text-decoration:underline}.xng-breadcrumb-link-disabled{cursor:disabled;pointer-events:none}.xng-breadcrumb-separator{-moz-user-select:none;-ms-user-select:none;-webkit-user-select:none;display:flex;margin-left:8px;margin-right:8px;user-select:none}"]}]}],g.ctorParameters=function(){return[{type:m},{type:t.Router}]},g.propDecorators={itemTemplate:[{type:r.ContentChild,args:[s,{static:!1,read:r.TemplateRef}]}],autoGenerate:[{type:r.Input}],preserveQueryParams:[{type:r.Input}],preserveFragment:[{type:r.Input}],class:[{type:r.Input}],separator:[{type:r.Input,args:["separator"]}]};var f=function(){};f.decorators=[{type:r.NgModule,args:[{declarations:[g,s],imports:[i.CommonModule,t.RouterModule],exports:[g,s]}]}],e.BreadcrumbComponent=g,e.BreadcrumbItemDirective=s,e.BreadcrumbModule=f,e.BreadcrumbService=m,e.ɵ0=p,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=xng-breadcrumb.umd.min.js.map